<!--
  Generated template for the ClaimReportPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar color="primary200">
    <ion-title>Claim Report</ion-title>
  </ion-navbar>

</ion-header>


<ion-content padding>

  <ion-item style="width: 49%;display:inline-block;">

    <ion-label>Department : </ion-label>
    <ion-select interface="popover" (ionChange)="BindEmployeesbyDepartment($event)" #ddlDept>
      <ion-option *ngFor="let dept of deptList" [value]="dept.DEPARTMENT_GUID">{{dept.NAME}}</ion-option>
    </ion-select>

  </ion-item>
  <ion-item style="width: 50%;display:inline-block;">

    <ion-label>User Name : </ion-label>

    <ion-select interface="popover" #ddlEmployee>
      <ion-option *ngFor="let emp of employeeList" [value]="emp.USER_GUID">{{emp.FULLNAME}}</ion-option>
    </ion-select>


  </ion-item>
  <ion-item style="width: 49%;display:inline-block;">
    <ion-label>

      Claim Month : </ion-label>

    <ion-select interface="popover" #ddlmonth>
      <ion-option value="1">Jan</ion-option>
      <ion-option value="2">Feb</ion-option>
      <ion-option value="3">Mar</ion-option>
      <ion-option value="4">Apr</ion-option>
      <ion-option value="5">May</ion-option>
      <ion-option value="6">Jun</ion-option>
      <ion-option value="7">Jul</ion-option>
      <ion-option value="8">Aug</ion-option>
      <ion-option value="9">Sep</ion-option>
      <ion-option value="10">Oct</ion-option>
      <ion-option value="11">Nov</ion-option>
      <ion-option value="12">Dec</ion-option>
    </ion-select>
  </ion-item>

  <!-- <ion-item style="width: 50%;display:inline-block;">
    <ion-label>Claim Type: </ion-label>
    <ion-select interface="popover" #ddlClaimTypes>
      <ion-option *ngFor="let claimType of claimTypeList" [value]="claimType.CLAIM_TYPE_GUID">{{claimType.NAME}}</ion-option>
    </ion-select>
  </ion-item>
   -->
  <ion-item>
    <button ion-button item-end (click)="SearchClaimsData(ddlDept.value,ddlEmployee.value,ddlmonth.value)">Search</button>
    <button ion-button item-end (click)="printToCart('printSectionId')">Print</button>
  </ion-item>
  <ion-list>
    <ion-item>
      <table class="Tabler ">
        <tr class="linedsg TColor">
          <th class="lgl1 tblBrLeft" style="width:40px">No.</th>
          <th class="lgl1">Claim Date</th>
          <th class="lgl1">Type</th>
          <th class="lgl1">Project/SOC/Customer</th>
          <!-- <th class="lgl1">Location as per SOC</th> -->
          <th class="lgl1">Mode</th>
          <!-- <th class="lgl1">Remarks(Location- if is not at customer location)</th> -->
          <!-- <th class="lgl1">Recommended Post Code</th> -->
          <th class="lgl1">From</th>
          <th class="lgl1">To</th>
          <!-- <th class="lgl1" *ngIf="travelClaimType" style="width:55px">Distance</th>
          <!-- <th class="lgl1">Distance(Outstn/Oths)KM</th> -->
          <!-- <th class="lgl1">Status</th>
          <th class="lgl1" *ngIf="travelClaimType" style="width:60px">Mileage</th>
          <th class="lgl1" *ngIf="travelClaimType" style="width:45px">Parking</th>
          <!-- <th class="lgl1">Parking (Without GST)</th> -->
          <!-- <th class="lgl1" *ngIf="travelClaimType" style="width:45px">Toll</th>
          <th class="lgl1" *ngIf="travelClaimType" style="width:45px">Meal</th>
          <th class="lgl1" *ngIf="travelClaimType" style="width:45px">Hotel</th> -->
          <!-- <th class="lgl1">Outstation Allowance</th>  -->
          <th class="lgl1 tblBrRight" style="width:130px">Total Amount(RM)</th>
        </tr>

        <tr class="col7" *ngFor="let claim of claimsList | paginate:{itemsPerPage: 10, currentPage:page, id: 'i' }; let i=index">
          <td class="lgl1">{{ 10 * (page - 1) + i+1 }}</td>
          <td class="lgl1">{{claim.TRAVEL_DATE | date:'d/M/y'}}</td>
          <td class="lgl1" text-wrap>{{claim.TYPE}}</td>
          <td class="lgl1" text-wrap>{{claim.PROJECT_NAME}} {{claim.SOC_NO}} {{claim.CUSTOMER_NAME}}</td>
          <td class="lgl1" text-wrap>{{claim.MODE}}</td>
          <td class="lgl1" text-wrap>{{claim.from}}</td>
          <td class="lgl1" text-wrap>{{claim.to}}</td>
          <!-- <td class="lgl1" *ngIf="travelClaimType">{{claim.DISTANCE_KM}}</td>
          <td class="lgl1">{{claim.STATUS}}</td>
          <td class="lgl1" *ngIf="travelClaimType">{{claim.MILEAGE_AMOUNT | number:'1.2-2'}}</td>
          <td class="lgl1" *ngIf="travelClaimType">{{claim.ParkingAmount | number:'1.2-2'}}</td>
          <td class="lgl1" *ngIf="travelClaimType">{{claim.TollAmount | number:'1.2-2'}}</td>
          <td class="lgl1" *ngIf="travelClaimType">{{claim.MealAmount | number:'1.2-2'}}</td>
          <td class="lgl1" *ngIf="travelClaimType">{{claim.AccAmount | number:'1.2-2'}}</td> -->
          <td class="lgl1">{{claim.Total | number:'1.2-2'}}</td>
        </tr>

        <tr class="col7">
          <td colspan="8" class="lgl11" style="color:#50C878;"> Total Amount(RM) : {{totalClaimAmount | number:'1.2-2'}}</td>
        </tr>
      </table>
      <pagination-controls style=" text-align: center;" (pageChange)="page=$event" id="i" maxSize="10" directionLinks="true" autoHide="true">
      </pagination-controls>
    </ion-item>
  </ion-list>
</ion-content>



<body id="printSectionId" hidden>
  <table width="100%" border="0" bgcolor="#cccccc">
    <table width="100%" border="0" bgcolor="#cccccc">
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr bgcolor="#002060" style="background-color:#002060;">
        <td align="left" valign="middle" bgcolor="#002060" colspan="4" style="border-right: none">
          <h2 style="color:#FFFFFF;">CLAIM REPORT</h2>
        </td>
        <td colspan="3" align="left" bgcolor="#002060" colspan=3 style="border-left: none">
          <h2 style="color:#ffffff;">{{ddlmonth.text}} {{todayDate.getFullYear()}}</h2>
        </td>
      </tr>
      <tr *ngFor="let item of empData">
        <td colspan="7" bgcolor="#ffffff">Company : {{item.tenant_company_name}}</td>
      </tr>
      <tr>
        <td colspan="4" bgcolor="#ffffff">Name : {{ddlEmployee.text}}</td>
        <td colspan="3" bgcolor="#ffffff">Department : {{ddlDept.text}}</td>
      </tr>
      <tr *ngFor="let item of empData">
        <td colspan="4" bgcolor="#ffffff">Position :{{item.designation_name}}</td>
        <td colspan="3" bgcolor="#ffffff">Approver :{{item.MANAGER}}</td>
      </tr>
      <tr>
        <td colspan="7" bgcolor="#ffffff">&nbsp;</td>
      </tr>
    </table>
    <table width="100%" border="0" bgcolor="#cccccc">
      <tr style="color:#ffffff;">
        <td align="center" bgcolor="#002060">Claim Date</td>
        <td align="center" bgcolor="#002060">Type</td>
        <td align="center" bgcolor="#002060">Details</td>
        <td align="center" bgcolor="#002060">Mode</td>
        <td align="center" bgcolor="#002060">From</td>
        <td align="center" bgcolor="#002060">To</td>
        <td align="center" bgcolor="#002060">Amount (RM)</td>
      </tr>
      <tr *ngFor="let claim of claimsListPrint">
        <td align="left" bgcolor="#ffffff">{{claim.TRAVEL_DATE | date:'d/M/y'}}</td>
        <td align="left" bgcolor="#ffffff">{{claim.TYPE}}</td>

        <td align="left" bgcolor="#ffffff">
          <table width="100%" style="border-bottom:1px solid grey">
            <tr>
              <td align="left" bgcolor="#ffffff">{{claim.PROJECT_NAME}}/{{claim.SOC}} {{claim.CUSTOMER_NAME}}</td>
            </tr>
          </table>
          <table width="100%" style="border-bottom:1px solid grey">
            <tr>
              <td align="left" bgcolor="#ffffff">{{claim.DESCRIPTION}}</td>
            </tr>
          </table>
          <table width="100%" style="border-bottom:1px solid grey" *ngIf="claim.TYPE==='TRV'">
            <tr>
              <td align="left" bgcolor="#ffffff">({{claim.DISTANCE_KM}}KM * RM{{claim.RATE_PER_UNIT}})</td>
            </tr>
          </table>

          <table width="100%" style="border-bottom:1px solid grey" *ngIf="claim.TYPE==='TRV'">
            <tr>
              <td align="left" bgcolor="#ffffff">Toll</td>
            </tr>
          </table>
          <table width="100%" style="border-bottom:1px solid grey" *ngIf="claim.TYPE==='TRV'">
            <tr>
              <td align="left" bgcolor="#ffffff">Parking</td>
            </tr>
          </table>
          <table width="100%" style="border-bottom:1px solid grey" *ngIf="claim.TYPE==='TRV'">
            <tr>
              <td align="left" bgcolor="#ffffff">Meal Allowance</td>
            </tr>
          </table>
          <table width="100%" *ngIf="claim.TYPE==='TRV'">
            <tr>
              <td align="left" bgcolor="#ffffff">Accomodation</td>
            </tr>
          </table>
          <table width="100%" style="border-bottom:1px solid grey" *ngIf="claim.TYPE==='OT'">
            <tr>
              <td align="left" bgcolor="#ffffff">Start date/time : {{claim.START_TS | date:'d/M/y HH:mm'}}</td>
            </tr>
          </table>
          <table width="100%" *ngIf="claim.TYPE==='OT'">
            <tr>
              <td align="left" bgcolor="#ffffff">End date / time: {{claim.END_TS | date:'d/M/y HH:mm'}}</td>
            </tr>
          </table>
        </td>
        <td align="left" bgcolor="#ffffff">{{claim.MODE}}</td>
        <td align="left" bgcolor="#ffffff">{{claim.from}}</td>
        <td align="left" bgcolor="#ffffff">{{claim.to}}</td>
        <td align="left" bgcolor="#ffffff">
          <table width="100%" style="border-bottom:1px solid grey">
            <tr>
              <td align="left" bgcolor="#ffffff">{{claim.MILEAGE_AMOUNT | number:'1.2-2'}}</td>
            </tr>
          </table>
          <table width="100%">
            <tr>
              <td align="left" bgcolor="#ffffff">&nbsp;</td>
            </tr>
          </table>
          <table width="100%" style="border-bottom:1px solid grey">
            <tr>
              <td align="left" bgcolor="#ffffff">&nbsp;</td>
            </tr>
          </table>
          <table width="100%" style="border-bottom:1px solid grey" *ngIf="claim.TYPE==='TRV'">
            <tr>
              <td align="left" bgcolor="#ffffff">{{claim.TollAmount | number:'1.2-2'}}</td>
            </tr>
          </table>
          <table width="100%" style="border-bottom:1px solid grey" *ngIf="claim.TYPE==='TRV'">
            <tr>
              <td align="left" bgcolor="#ffffff">{{claim.ParkingAmount | number:'1.2-2'}}</td>
            </tr>
          </table>
          <table width="100%" style="border-bottom:1px solid grey" *ngIf="claim.TYPE==='TRV'">
            <tr>
              <td align="left" bgcolor="#ffffff">{{claim.MealAmount | number:'1.2-2'}}</td>
            </tr>
          </table>
          <table width="100%" *ngIf="claim.TYPE==='TRV'">
            <tr>
              <td align="left" bgcolor="#ffffff">{{claim.AccAmount | number:'1.2-2'}}</td>
            </tr>
          </table>
        </td>
      </tr>

      <tr>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC" colspan="2">TOTAL CLAIM AMOUNT</td>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC">{{totalClaimAmount | number:'1.2-2'}}</td>
      </tr>
      <tr>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
      </tr>
      <tr>
        <td align="left">&nbsp;</td>
        <td align="left">&nbsp;</td>
        <td align="left">&nbsp;</td>
        <td align="left">&nbsp;</td>
        <td align="left">&nbsp;</td>
        <td align="left">&nbsp;</td>
        <td align="left">&nbsp;</td>
      </tr>
    </table>
    <table width="100%" border="0" bgcolor="#cccccc">
      <tr style="color:#ffffff;">
        <td colspan="6" align="left" bgcolor="#002060">CLAIMS SUMMARY</td>
        <td align="left" bgcolor="#002060">Amount (RM)</td>
      </tr>
      <tr *ngFor="let claim of claimsListSummery">
        <td align="left" bgcolor="#ffffff">&nbsp;</td>
        <td align="left" bgcolor="#ffffff">{{claim.TRAVEL}}</td>
        <td align="left" bgcolor="#ffffff">{{claim.MILEAGE}} </td>
        <td align="left" bgcolor="#ffffff">{{claim.SHORTFORM}} </td>
        <td colspan="2" align="left" bgcolor="#ffffff">&nbsp;</td>
        <td align="left" bgcolor="#ffffff">{{claim.AMOUNT| number:'1.2-2'}}</td>
      </tr>
      <tr>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC">TOTAL CLAIM AMOUNT</td>
        <td align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td colspan="2" align="left" bgcolor="#B3CCEC">&nbsp;</td>
        <td align="left" bgcolor="#B3CCEC">{{totalClaimAmount | number:'1.2-2'}}</td>
      </tr>
    </table>
  </table>

</body>